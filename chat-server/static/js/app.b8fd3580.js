(function(){"use strict";var e={4770:function(e,s,t){var n=t(9963),o=t(6252);function r(e,s,t,n,r,i){const a=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(a)}var i={name:"App"},a=t(3744);const c=(0,a.Z)(i,[["render",r]]);var u=c,l=t(2119);const m={class:"home-container"},d={class:"sidebar"},h={class:"main"};function f(e,s,t,n,r,i){const a=(0,o.up)("card_com"),c=(0,o.up)("list_com"),u=(0,o.up)("message_com"),l=(0,o.up)("chat_com");return(0,o.wg)(),(0,o.iD)("div",m,[e.$store.state.user?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",d,[(0,o.Wm)(a),(0,o.Wm)(c)]),(0,o._)("div",h,[(0,o.Wm)(u),(0,o.Wm)(l)])],64)):(0,o.kq)("",!0)])}t(7658);var _=t(3577);const g={class:"card"},p=["src"],v={class:"name"};function S(e,s,t,n,r,i){return(0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("header",null,[(0,o._)("img",{class:"avatar",width:"40",height:"40",alt:"username",src:e.$socket.server_host+this.$store.state.user.avatar},null,8,p),(0,o._)("p",v,(0,_.zw)(this.$store.state.user.username),1)])])}var w={name:"card_com",computed:{user(){return this.$store.state.user}}};const E=(0,a.Z)(w,[["render",S],["__scopeId","data-v-da9123a8"]]);var k=E;const y={class:"list"},$=["onClick"],b=["alt","src"],O={class:"name"};function D(e,s,t,n,r,i){const a=(0,o.up)("el-badge");return(0,o.wg)(),(0,o.iD)("div",y,[(0,o._)("ul",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.sessions,(s=>((0,o.wg)(),(0,o.iD)("li",{onClick:e=>i.onSelectSession(s),class:(0,_.C_)({active:i.current_session&&s.user.sid==i.current_session.user.sid}),key:s.user.sid},[(0,o._)("img",{class:"avatar",width:"30",height:"30",alt:s.user.username,src:e.$socket.server_host+s.user.avatar},null,8,b),(0,o.Wm)(a,{value:s.unread,class:"item",hidden:0==s.unread},{default:(0,o.w5)((()=>[(0,o._)("p",O,(0,_.zw)(s.user.username)+"("+(0,_.zw)(s.user.ip)+")",1)])),_:2},1032,["value","hidden"])],10,$)))),128))])])}var C={name:"list_com",computed:{sessions(){return this.$store.state.sessions},current_session(){return this.$store.state.current_session}},mounted(){this.$socket.onFriendOnline((e=>{let s=e.user;this.$store.commit("ADD_SESSION",s)})),this.$socket.onFriendOffline((e=>{let s=e.user;this.$store.commit("DELETE_SESSION",s)}))},methods:{onSelectSession(e){this.$store.commit("SET_CURRENT_SESSION",e)}}};const T=(0,a.Z)(C,[["render",D],["__scopeId","data-v-5f55fd00"]]);var I=T;const M={class:"text"};function N(e,s,t,r,i,a){return(0,o.wg)(),(0,o.iD)("div",M,[(0,o.wy)((0,o._)("textarea",{placeholder:"Ctrl^ + Enter","onUpdate:modelValue":s[0]||(s[0]=e=>i.content=e),onKeyup:s[1]||(s[1]=(...e)=>a.onKeyup&&a.onKeyup(...e))},null,544),[[n.nr,i.content]])])}var x=t(1348),R={name:"chat_com",computed:{current_session(){return this.$store.state.current_session}},data(){return{content:""}},methods:{onKeyup(e){if(e.ctrlKey&&13===e.keyCode&&this.content.length){if(!this.current_session)return void x.z8.info("Please select a user");const e=this.content;this.$socket.emitSendMessage({to:this.current_session.user.sid,message:this.content},(s=>{200==s["code"]&&this.$store.commit("SEND_MESSAGE",e)})),this.content=""}}}};const W=(0,a.Z)(R,[["render",N],["__scopeId","data-v-6cfddd5e"]]);var j=W;const z={class:"message",ref:"el"},Z={key:0},A={class:"time"},F=["src"],H={class:"text"};function K(e,s,t,n,r,i){return(0,o.wg)(),(0,o.iD)("div",z,[i.current_session?((0,o.wg)(),(0,o.iD)("ul",Z,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.current_session.messages,((s,t)=>((0,o.wg)(),(0,o.iD)("li",{key:t},[(0,o._)("p",A,[(0,o._)("span",null,(0,_.zw)(i.timeFormat(s.date)),1)]),(0,o._)("div",{class:(0,_.C_)({main:!0,self:s.self})},[(0,o._)("img",{class:"avatar",width:"30",height:"30",src:e.$socket.server_host+i.user.avatar},null,8,F),(0,o._)("div",H,(0,_.zw)(s.content),1)],2)])))),128))])):(0,o.kq)("",!0)],512)}var P={name:"message_com",computed:{current_session(){return this.$store.state.current_session},user(){return this.$store.state.user}},methods:{timeFormat(e){return"string"===typeof e&&(e=new Date(e)),e.getHours()+":"+e.getMinutes()}},updated(){this.$nextTick((()=>{var e=this.$refs.el;e.scrollTop=e.scrollHeight}))},mounted(){this.$socket.onReceiveMessage((e=>{const s=e["from"],t=e["message"];this.$store.commit("RECEIVE_MESSAGE",{sid:s,content:t})}))}};const U=(0,a.Z)(P,[["render",K],["__scopeId","data-v-351dff66"]]);var L=U,V={name:"HomeComponent",created(){},mounted(){this.$store.getters.logined||this.$router.push({name:"login"})},components:{card_com:k,list_com:I,chat_com:j,message_com:L}};const G=(0,a.Z)(V,[["render",f],["__scopeId","data-v-753f03ef"]]);var Y=G;const q=e=>((0,o.dD)("data-v-346fae06"),e=e(),(0,o.Cn)(),e),B={class:"login-container"},J=q((()=>(0,o._)("h1",{class:"h1_stylish"},"Hello Chatbot",-1)));function Q(e,s,t,n,r,i){const a=(0,o.up)("el-input"),c=(0,o.up)("el-form-item"),u=(0,o.up)("el-button"),l=(0,o.up)("el-form");return(0,o.wg)(),(0,o.iD)("div",B,[(0,o.Wm)(l,{ref:"form",model:r.form,class:"login-main"},{default:(0,o.w5)((()=>[J,(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(a,{modelValue:r.form.username,"onUpdate:modelValue":s[0]||(s[0]=e=>r.form.username=e),placeholder:"username"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(c,{style:{"text-align":"right"}},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{type:"primary",onClick:i.onSubmit},{default:(0,o.w5)((()=>[(0,o.Uk)("Login")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])}var X={name:"LoginComponent",data(){return{form:{username:""}}},mounted(){},methods:{onSubmit(){this.form.username?(this.$socket.connected||this.$socket.connect(),this.$socket.emitLogin(this.form.username,(e=>{if(console.log(e),200==e["code"]){const s=e["data"],t=s["user"],n=s["online_users"];this.$store.commit("SET_SESSIONS",n),this.$store.commit("SET_USER",t),this.$router.push({name:"home"})}else console.log("error"),console.log(e["message"]),x.z8.error(e["message"])}))):x.z8.error("Please enter your username")}}};const ee=(0,a.Z)(X,[["render",Q],["__scopeId","data-v-346fae06"]]);var se=ee;const te=[{path:"/",component:Y,name:"home"},{path:"/login",component:se,name:"login"}],ne=(0,l.p7)({history:(0,l.r5)(),routes:te});var oe=ne,re=t(3907);const ie=(0,re.MT)({state:{user:null,sessions:[],current_session:null},mutations:{SET_USER(e,s){e.user=s},ADD_SESSION(e,s){e.sessions.push({user:s,messages:[],unread:0})},DELETE_SESSION(e,s){for(let t=0;t<e.sessions.length;t++){let n=e.sessions[t];if(n.user.sid==s.sid){e.sessions.splice(t,1),e.current_session.user.sid==n.user.sid&&(e.current_session=null);break}}},SET_SESSIONS(e,s){const t=[];for(let n of s)t.push({user:n,messages:[],unread:0});e.sessions=t},SET_CURRENT_SESSION(e,s){s.unread=0,e.current_session=s},SEND_MESSAGE(e,s){e.current_session&&e.current_session.messages.push({content:s,date:new Date,self:!0})},RECEIVE_MESSAGE(e,s){const t=s["sid"],n=s["content"];let o=null;for(let r of e.sessions)if(r.user.sid==t){o=r;break}o&&(o.messages.push({content:n,date:new Date,self:!1}),e.current_session&&e.current_session.user.sid==o.user.sid||(o.unread+=1))}},getters:{logined(e){return!!e.user}}});var ae=ie,ce=t(26),ue=(t(4415),t(9367));class le{constructor(){this.server_host=window.location.origin,this.socket=(0,ue.io)(this.server_host)}connect(){this.socket.connect()}emitLogin(e,s){this.socket.emit("login",{username:e},(e=>{s&&s(e)}))}onFriendOnline(e){this.socket.on("friend online",(s=>{e&&e(s)}))}onFriendOffline(e){this.socket.on("friend offline",(s=>{e&&e(s)}))}emitSendMessage(e,s){this.socket.emit("send message",{to:e["to"],message:e["message"]},(e=>{s&&s(e)}))}onReceiveMessage(e){this.socket.on("receive message",(s=>{e&&e(s)}))}get connected(){return this.socket.connected}}var me=new le;const de=(0,n.ri)(u);de.use(oe),de.use(ae),de.use(ce.Z),de.config.globalProperties.$socket=me,de.mount("#app")}},s={};function t(n){var o=s[n];if(void 0!==o)return o.exports;var r=s[n]={exports:{}};return e[n].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(s,n,o,r){if(!n){var i=1/0;for(l=0;l<e.length;l++){n=e[l][0],o=e[l][1],r=e[l][2];for(var a=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(t.O).every((function(e){return t.O[e](n[c])}))?n.splice(c--,1):(a=!1,r<i&&(i=r));if(a){e.splice(l--,1);var u=o();void 0!==u&&(s=u)}}return s}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[n,o,r]}}(),function(){t.d=function(e,s){for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,n){var o,r,i=n[0],a=n[1],c=n[2],u=0;if(i.some((function(s){return 0!==e[s]}))){for(o in a)t.o(a,o)&&(t.m[o]=a[o]);if(c)var l=c(t)}for(s&&s(n);u<i.length;u++)r=i[u],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(l)},n=self["webpackChunkchat_client"]=self["webpackChunkchat_client"]||[];n.forEach(s.bind(null,0)),n.push=s.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(4770)}));n=t.O(n)})();